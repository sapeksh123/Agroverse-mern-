{"ast":null,"code":"\"use client\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\annpu\\\\OneDrive\\\\Desktop\\\\Agroverse-mern-\\\\client\\\\src\\\\context\\\\AuthContext.jsx\",\n  _s = $RefreshSig$();\nimport { createContext, useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport { API_URL } from \"../config\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext();\nexport const AuthProvider = ({\n  children\n}) => {\n  _s();\n  const [user, setUser] = useState(null);\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  // Load user on initial render\n  useEffect(() => {\n    const loadUser = async () => {\n      if (localStorage.token) {\n        setAuthToken(localStorage.token);\n        try {\n          const res = await axios.get(`${API_URL}/api/auth/me`);\n          setUser(res.data);\n          setIsAuthenticated(true);\n        } catch (err) {\n          var _err$response, _err$response$data;\n          localStorage.removeItem(\"token\");\n          setUser(null);\n          setIsAuthenticated(false);\n          setError(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || \"Authentication failed\");\n        }\n      }\n      setLoading(false);\n    };\n    loadUser();\n  }, []);\n\n  // Set auth token in headers\n  const setAuthToken = token => {\n    if (token) {\n      axios.defaults.headers.common[\"x-auth-token\"] = token;\n      localStorage.setItem(\"token\", token);\n    } else {\n      delete axios.defaults.headers.common[\"x-auth-token\"];\n      localStorage.removeItem(\"token\");\n    }\n  };\n\n  // Register user\n  const register = async formData => {\n    try {\n      const res = await axios.post(`${API_URL}/api/users`, formData);\n      setAuthToken(res.data.token);\n      loadUser();\n      return {\n        success: true\n      };\n    } catch (err) {\n      var _err$response2, _err$response2$data, _err$response3, _err$response3$data;\n      setError(((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : (_err$response2$data = _err$response2.data) === null || _err$response2$data === void 0 ? void 0 : _err$response2$data.message) || \"Registration failed\");\n      return {\n        success: false,\n        error: ((_err$response3 = err.response) === null || _err$response3 === void 0 ? void 0 : (_err$response3$data = _err$response3.data) === null || _err$response3$data === void 0 ? void 0 : _err$response3$data.message) || \"Registration failed\"\n      };\n    }\n  };\n\n  // Login user\n  const login = async (email, password) => {\n    try {\n      const res = await axios.post(`${API_URL}/api/auth/login`, {\n        email,\n        password\n      });\n      setAuthToken(res.data.token);\n      const userRes = await axios.get(`${API_URL}/api/auth/me`);\n      setUser(userRes.data);\n      setIsAuthenticated(true);\n      setError(null);\n      return {\n        success: true\n      };\n    } catch (err) {\n      var _err$response4, _err$response4$data, _err$response5, _err$response5$data;\n      setError(((_err$response4 = err.response) === null || _err$response4 === void 0 ? void 0 : (_err$response4$data = _err$response4.data) === null || _err$response4$data === void 0 ? void 0 : _err$response4$data.message) || \"Login failed\");\n      return {\n        success: false,\n        error: ((_err$response5 = err.response) === null || _err$response5 === void 0 ? void 0 : (_err$response5$data = _err$response5.data) === null || _err$response5$data === void 0 ? void 0 : _err$response5$data.message) || \"Login failed\"\n      };\n    }\n  };\n\n  // Load user\n  const loadUser = async () => {\n    if (localStorage.token) {\n      setAuthToken(localStorage.token);\n      try {\n        const res = await axios.get(`${API_URL}/api/auth/me`);\n        setUser(res.data);\n        setIsAuthenticated(true);\n        setError(null);\n      } catch (err) {\n        var _err$response6, _err$response6$data;\n        setUser(null);\n        setIsAuthenticated(false);\n        setError(((_err$response6 = err.response) === null || _err$response6 === void 0 ? void 0 : (_err$response6$data = _err$response6.data) === null || _err$response6$data === void 0 ? void 0 : _err$response6$data.message) || \"Authentication failed\");\n      }\n    }\n  };\n\n  // Logout user\n  const logout = () => {\n    setAuthToken(null);\n    setUser(null);\n    setIsAuthenticated(false);\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      user,\n      isAuthenticated,\n      loading,\n      error,\n      register,\n      login,\n      logout,\n      loadUser\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 103,\n    columnNumber: 5\n  }, this);\n};\n_s(AuthProvider, \"AaZCefjEQIISzggwPe9U62ieYJk=\");\n_c = AuthProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["_jsxFileName","_s","$RefreshSig$","createContext","useState","useEffect","axios","API_URL","jsxDEV","_jsxDEV","AuthContext","AuthProvider","children","user","setUser","isAuthenticated","setIsAuthenticated","loading","setLoading","error","setError","loadUser","localStorage","token","setAuthToken","res","get","data","err","_err$response","_err$response$data","removeItem","response","message","defaults","headers","common","setItem","register","formData","post","success","_err$response2","_err$response2$data","_err$response3","_err$response3$data","login","email","password","userRes","_err$response4","_err$response4$data","_err$response5","_err$response5$data","_err$response6","_err$response6$data","logout","Provider","value","fileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/annpu/OneDrive/Desktop/Agroverse-mern-/client/src/context/AuthContext.jsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { createContext, useState, useEffect } from \"react\"\r\nimport axios from \"axios\"\r\nimport { API_URL } from \"../config\"\r\n\r\nexport const AuthContext = createContext()\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n  const [user, setUser] = useState(null)\r\n  const [isAuthenticated, setIsAuthenticated] = useState(false)\r\n  const [loading, setLoading] = useState(true)\r\n  const [error, setError] = useState(null)\r\n\r\n  // Load user on initial render\r\n  useEffect(() => {\r\n    const loadUser = async () => {\r\n      if (localStorage.token) {\r\n        setAuthToken(localStorage.token)\r\n        try {\r\n          const res = await axios.get(`${API_URL}/api/auth/me`)\r\n          setUser(res.data)\r\n          setIsAuthenticated(true)\r\n        } catch (err) {\r\n          localStorage.removeItem(\"token\")\r\n          setUser(null)\r\n          setIsAuthenticated(false)\r\n          setError(err.response?.data?.message || \"Authentication failed\")\r\n        }\r\n      }\r\n      setLoading(false)\r\n    }\r\n\r\n    loadUser()\r\n  }, [])\r\n\r\n  // Set auth token in headers\r\n  const setAuthToken = (token) => {\r\n    if (token) {\r\n      axios.defaults.headers.common[\"x-auth-token\"] = token\r\n      localStorage.setItem(\"token\", token)\r\n    } else {\r\n      delete axios.defaults.headers.common[\"x-auth-token\"]\r\n      localStorage.removeItem(\"token\")\r\n    }\r\n  }\r\n\r\n  // Register user\r\n  const register = async (formData) => {\r\n    try {\r\n      const res = await axios.post(`${API_URL}/api/users`, formData)\r\n      setAuthToken(res.data.token)\r\n      loadUser()\r\n      return { success: true }\r\n    } catch (err) {\r\n      setError(err.response?.data?.message || \"Registration failed\")\r\n      return { success: false, error: err.response?.data?.message || \"Registration failed\" }\r\n    }\r\n  }\r\n\r\n  // Login user\r\n  const login = async (email, password) => {\r\n    try {\r\n      const res = await axios.post(`${API_URL}/api/auth/login`, { email, password })\r\n      setAuthToken(res.data.token)\r\n\r\n      const userRes = await axios.get(`${API_URL}/api/auth/me`)\r\n      setUser(userRes.data)\r\n      setIsAuthenticated(true)\r\n      setError(null)\r\n      return { success: true }\r\n    } catch (err) {\r\n      setError(err.response?.data?.message || \"Login failed\")\r\n      return { success: false, error: err.response?.data?.message || \"Login failed\" }\r\n    }\r\n  }\r\n\r\n  // Load user\r\n  const loadUser = async () => {\r\n    if (localStorage.token) {\r\n      setAuthToken(localStorage.token)\r\n      try {\r\n        const res = await axios.get(`${API_URL}/api/auth/me`)\r\n        setUser(res.data)\r\n        setIsAuthenticated(true)\r\n        setError(null)\r\n      } catch (err) {\r\n        setUser(null)\r\n        setIsAuthenticated(false)\r\n        setError(err.response?.data?.message || \"Authentication failed\")\r\n      }\r\n    }\r\n  }\r\n\r\n  // Logout user\r\n  const logout = () => {\r\n    setAuthToken(null)\r\n    setUser(null)\r\n    setIsAuthenticated(false)\r\n  }\r\n\r\n  return (\r\n    <AuthContext.Provider\r\n      value={{\r\n        user,\r\n        isAuthenticated,\r\n        loading,\r\n        error,\r\n        register,\r\n        login,\r\n        logout,\r\n        loadUser,\r\n      }}\r\n    >\r\n      {children}\r\n    </AuthContext.Provider>\r\n  )\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}